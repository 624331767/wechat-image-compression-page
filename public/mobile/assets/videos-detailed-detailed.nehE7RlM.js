var t,e;import{o as a,c as l,w as s,g as o,b as i,h as d,C as n,r,d as c,e as u,n as f,a as g,t as h,x as p,i as v,v as y,y as _,D as b,E as m,f as C,l as x,F as k,G as I,H as S}from"./index-Bg5GmJtU.js";import{_ as $,m as q,a as D,r as T,b as w,c as B,t as P}from"./api.BcbxCNO6.js";const E=$({name:"uv-status-bar",mixins:[q,D,{props:{bgColor:{type:String,default:"transparent"}}}],data:()=>({}),computed:{style(){const t={};return t.height=this.$uv.addUnit(this.$uv.sys().statusBarHeight,"px"),this.bgColor&&(this.bgColor.indexOf("gradient")>-1?t.backgroundImage=this.bgColor:t.background=this.bgColor),this.$uv.deepMerge(t,this.$uv.addStyle(this.customStyle))}}},[["render",function(t,e,n,r,c,u){const f=d;return a(),l(f,{style:i([u.style]),class:"uv-status-bar"},{default:s((()=>[o(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}],["__scopeId","data-v-c48287dc"]]);const V=$({name:"uv-navbar",mixins:[q,D,{props:{safeAreaInsetTop:{type:Boolean,default:!0},placeholder:{type:Boolean,default:!1},fixed:{type:Boolean,default:!0},border:{type:Boolean,default:!1},leftIcon:{type:String,default:"arrow-left"},leftText:{type:String,default:""},rightText:{type:String,default:""},rightIcon:{type:String,default:""},title:{type:[String,Number],default:""},bgColor:{type:String,default:"#ffffff"},imgMode:{type:String,default:"aspectFill"},titleWidth:{type:[String,Number],default:"400rpx"},height:{type:[String,Number],default:"44px"},leftIconSize:{type:[String,Number],default:20},leftIconColor:{type:String,default:"#303133"},autoBack:{type:Boolean,default:!1},titleStyle:{type:[String,Object],default:""},...null==(e=null==(t=uni.$uv)?void 0:t.props)?void 0:e.navbar}}],data:()=>({}),computed:{getBgColor(){const t={};return this.bgColor&&(this.bgColor.indexOf("gradient")>-1?t.backgroundImage=this.bgColor:this.isImg?t.background="transparent":t.background=this.bgColor),t},getStatusbgColor(){if(this.bgColor)return this.isImg?"transparent":this.bgColor},isImg(){const t=this.bgColor.indexOf("data:")>-1&&this.bgColor.indexOf("base64")>-1;return-1!==this.bgColor.indexOf("/")||t},bgImgStyle(){const t={};return this.safeAreaInsetTop?t.height=this.$uv.addUnit(this.$uv.sys().statusBarHeight+44,"px"):t.height="44px",t}},methods:{leftClick(){this.$emit("leftClick"),this.autoBack&&n()},rightClick(){this.$emit("rightClick")}}},[["render",function(t,e,n,y,_,b){const m=d,C=p,x=T(r("uv-status-bar"),E),k=T(r("uv-icon"),w),I=v;return a(),l(m,{class:"uv-navbar"},{default:s((()=>[t.fixed&&t.placeholder?(a(),l(m,{key:0,class:"uv-navbar__placeholder",style:i({height:t.$uv.addUnit(t.$uv.getPx(t.height)+t.$uv.sys().statusBarHeight,"px")})},null,8,["style"])):c("",!0),u(m,{class:f([t.fixed&&"uv-navbar--fixed"])},{default:s((()=>[b.isImg?(a(),l(C,{key:0,class:"uv-navbar--bgimg",src:t.bgColor,mode:t.imgMode,style:i([b.bgImgStyle])},null,8,["src","mode","style"])):c("",!0),t.safeAreaInsetTop?(a(),l(x,{key:1,bgColor:b.getStatusbgColor},null,8,["bgColor"])):c("",!0),u(m,{class:f(["uv-navbar__content",[t.border&&"uv-border-bottom"]]),style:i([{height:t.$uv.addUnit(t.height)},b.getBgColor])},{default:s((()=>[u(m,{class:"uv-navbar__content__left","hover-class":"uv-navbar__content__left--hover","hover-start-time":"150",onClick:b.leftClick},{default:s((()=>[o(t.$slots,"left",{},(()=>[t.leftIcon?(a(),l(k,{key:0,name:t.leftIcon,size:t.leftIconSize,color:t.leftIconColor},null,8,["name","size","color"])):c("",!0),t.leftText?(a(),l(I,{key:1,style:i({color:t.leftIconColor}),class:"uv-navbar__content__left__text"},{default:s((()=>[g(h(t.leftText),1)])),_:1},8,["style"])):c("",!0)]),!0)])),_:3},8,["onClick"]),o(t.$slots,"center",{},(()=>[u(I,{class:"uv-line-1 uv-navbar__content__title",style:i([{width:t.$uv.addUnit(t.titleWidth),flex:"0 1 auto"},t.$uv.addStyle(t.titleStyle)])},{default:s((()=>[g(h(t.title),1)])),_:1},8,["style"])]),!0),u(m,{class:"uv-navbar__content__right",onClick:b.rightClick},{default:s((()=>[o(t.$slots,"right",{},(()=>[t.rightIcon?(a(),l(k,{key:0,name:t.rightIcon,size:"20"},null,8,["name"])):c("",!0),t.rightText?(a(),l(I,{key:1,class:"uv-navbar__content__right__text"},{default:s((()=>[g(h(t.rightText),1)])),_:1})):c("",!0)]),!0)])),_:3},8,["onClick"])])),_:3},8,["class","style"])])),_:3},8,["class"])])),_:3})}],["__scopeId","data-v-7b22089e"]]);const L=$({data:()=>({quality:{src:"",poster:"",title:"",view_count:0,created_at:"",description:"",autoplay:!1,muted:!1},isDescExpanded:!1,relatedVideoList:[]}),onLoad(t){this.getVideoDetail(t.id),this.getRecommendVideos()},methods:{leftClickRouter(){y({url:"../../pages/main/main"})},toggleDescription(){this.isDescExpanded=!this.isDescExpanded},async getVideoDetail(t){try{const e=(await B.videos.getVideoDetail(t)).data;this.quality.src=e.video_url,this.quality.poster=e.cover_url,this.quality.title=e.title,this.quality.view_count=e.view_count,this.quality.created_at=P(e.created_at),this.quality.description=e.description,_({title:e.title})}catch(e){console.error("获取视频详情失败:",e)}},async getRecommendVideos(){try{const t=await B.videos.getRecommend({count:4});this.relatedVideoList=t.data.map((t=>({...t,created_at:P(t.created_at)})))}catch(t){console.error("获取相关推荐视频失败:",t)}},goToVideoDetail(t){this.getVideoDetail(t.id),b({scrollTop:0,duration:300})},onPlay(){console.log("视频播放中")},onPause(){console.log("视频暂停")},onEnded(){console.log("视频播放结束")},togglePlay(){const t=this.$refs.videoPlayer;t&&(t.paused?t.play():t.pause())}}},[["render",function(t,e,o,i,n,c){const y=T(r("uv-navbar"),V),_=I,b=d,$=v,q=S,D=p;return a(),l(b,{class:"video-detail-page"},{default:s((()=>[u(y,{title:"视频播放",safeAreaInsetTop:"",placeholder:"",fixed:"",onLeftClick:c.leftClickRouter},null,8,["onLeftClick"]),u(b,{class:"video-section"},{default:s((()=>[u(_,{ref:"videoPlayer",src:n.quality.src,poster:n.quality.poster,autoplay:n.quality.autoplay,muted:n.quality.muted,controls:"",style:{width:"100%",height:"250px"},onPlay:c.onPlay,onPause:c.onPause,onEnded:c.onEnded},null,8,["src","poster","autoplay","muted","onPlay","onPause","onEnded"])])),_:1}),u(b,{class:"video-info"},{default:s((()=>[u(b,{class:"video-title"},{default:s((()=>[g(h(n.quality.title),1)])),_:1}),u(b,{class:"video-stats"},{default:s((()=>[u(b,{class:"stats-left"},{default:s((()=>[u(b,{class:"play-count"},{default:s((()=>[m("i",{class:"fa fa-eye"}),u($,null,{default:s((()=>[g(h(n.quality.view_count)+" 次播放",1)])),_:1})])),_:1}),u(b,{class:"publish-time"},{default:s((()=>[g(h(n.quality.created_at)+" 发布",1)])),_:1})])),_:1})])),_:1}),u(b,{class:"divider"}),u(b,{class:"video-description"},{default:s((()=>[u(b,{class:"desc-title"},{default:s((()=>[g("视频描述")])),_:1}),u(b,{class:f(["desc-content",{"desc-expanded":n.isDescExpanded}])},{default:s((()=>[g(h(n.quality.description),1)])),_:1},8,["class"]),u(q,{class:"toggle-desc-btn",onClick:c.toggleDescription},{default:s((()=>[u($,null,{default:s((()=>[g(h(n.isDescExpanded?"收起":"展开更多"),1)])),_:1}),m("i",{class:f(["fa",n.isDescExpanded?"fa-chevron-up":"fa-chevron-down"])},null,2)])),_:1},8,["onClick"])])),_:1}),u(b,{class:"related-videos"},{default:s((()=>[u(b,{class:"related-title"},{default:s((()=>[g("相关推荐视频")])),_:1}),u(b,{class:"related-list"},{default:s((()=>[(a(!0),C(k,null,x(n.relatedVideoList,((t,e)=>(a(),l(b,{class:"related-item",key:t.id,onClick:e=>c.goToVideoDetail(t)},{default:s((()=>[u(b,{class:"related-video-container"},{default:s((()=>[u(D,{src:t.cover_url,class:"related-video-cover",mode:"aspectFill"},null,8,["src"]),u(b,{class:"related-video-duration"},{default:s((()=>[g(h(t.duration),1)])),_:2},1024)])),_:2},1024),u(b,{class:"related-video-info"},{default:s((()=>[u(b,{class:"related-video-title"},{default:s((()=>[g(h(t.title),1)])),_:2},1024),u(b,{class:"related-video-playcount"},{default:s((()=>[g(h(t.view_count)+" 次播放",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-84526b10"]]);export{L as default};
